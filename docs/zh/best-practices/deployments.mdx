---
title: "éƒ¨ç½² Stagehand"
description: "å°† AI ä»£ç†ä¸è‡ªåŠ¨åŒ–éƒ¨ç½²åˆ°äº‘ç«¯"
---

<Tip>
  **ğŸŒŸ é¢„è§ˆï¼šBrowser Functions** - ä½¿ç”¨ Browser Functions å°†ç½‘é¡µè‡ªåŠ¨åŒ–ä»£ç ç›´æ¥éƒ¨ç½²åˆ° Browserbaseã€‚é›¶åŸºç¡€è®¾æ–½é…ç½®ï¼Œåœ¨äº‘ç«¯æ¨ªå‘æ‰©å±•ä½ çš„ `act()` è‡ªåŠ¨åŒ–ã€‚è”ç³» hello@browserbase.com è·å–æµ‹è¯•ç‰ˆè®¿é—®æƒé™ã€‚
</Tip>

## éƒ¨ç½²åˆ° Vercel {#deploy-on-vercel}

åœ¨ Vercel Function ä¸­é€šè¿‡ Browserbase å®‰å…¨è¿è¡Œ Stagehandã€‚æœ¬æŒ‡å—æä¾›ä¸€ä¸ªæœ€å°å¯ç”¨ã€å¯ç”¨äºç”Ÿäº§çš„ HTTP ç«¯ç‚¹ï¼Œä½ å¯ä»¥ç›´æ¥è°ƒç”¨æˆ–æŒ‰è®¡åˆ’è§¦å‘ã€‚

### 1. å®‰è£… Vercel CLI {#1-install-vercel-cli}

è¦ä¸‹è½½å¹¶å®‰è£… Vercel CLIï¼Œè¿è¡Œä»¥ä¸‹ä»»ä¸€å‘½ä»¤ï¼š

<CodeGroup>
  ```bash pnpm
  pnpm i -g vercel
  ```

  ```bash yarn
  yarn global add vercel
  ```

  ```bash npm
  npm i -g vercel
  ```

  ```bash bun
  bun add -g vercel
  ```
</CodeGroup>

### 2. é¡¹ç›®ç»“æ„ {#2-project-layout}

```text
your-project/
  api/
    run.ts
  package.json
  tsconfig.json
  vercel.json
```

åˆ›å»ºè¯¥ç»“æ„ï¼š

```bash
mkdir -p api
touch api/run.ts package.json vercel.json tsconfig.json
```

### 3. `api/run.ts`ï¼ˆNode.js è¿è¡Œæ—¶ï¼‰ {#3-apirunts-nodejs-runtime}

```typescript
// api/run.ts
import type { VercelRequest, VercelResponse } from "@vercel/node";
import { Stagehand } from "@browserbasehq/stagehand";
import { z } from "zod";

export default async function handler(req: VercelRequest, res: VercelResponse): Promise<void> {
  try {
    const stagehand = new Stagehand({
      env: "BROWSERBASE",
      apiKey: process.env.BROWSERBASE_API_KEY!,
      projectId: process.env.BROWSERBASE_PROJECT_ID!,
      modelName: "google/gemini-2.5-flash",
      modelClientOptions: {
        apiKey: process.env.GOOGLE_API_KEY!,
      },
      // optional session params
      browserbaseSessionCreateParams: {
        projectId: process.env.BROWSERBASE_PROJECT_ID!,
        region: "us-west-2",
        browserSettings: {
          blockAds: true,
        },
      },
    });

    await stagehand.init();
    const page = stagehand.page;

    await page.goto("https://www.stagehand.dev/");
    await page.act("click the evals button");

    const { extraction } = await page.extract("extract the fastest model");
    const data = { model: extraction ?? "" };

    await stagehand.close();

    res.status(200).json({ ok: true, data: data.model });
  } catch (err: unknown) {
    const msg = err instanceof Error ? err.message : String(err);
    res.status(500).json({ ok: false, error: msg });
  }
}
```

### 4. `package.json` {#4-packagejson}

```json
{
    "name": "bb-stagehand-on-vercel",
    "private": true,
    "type": "module",
    "engines": { "node": ">=18" },
    "dependencies": {
      "@browserbasehq/stagehand": "^2.4.3",
      "zod": "^3.25.0"
    },
    "devDependencies": {
      "typescript": "^5.6.0",
      "@types/node": "^20.12.12",
      "@vercel/node": "^3.2.20"
    }
}
```

### 5. `tsconfig.json` {#5-tsconfigjson}

```json
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "ES2022",
    "moduleResolution": "node",
    "outDir": ".vercel/output/functions",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "types": ["node"]
  },
  "include": ["api/**/*.ts"]
}
```

### 6. `vercel.json` {#6-verceljson}

```json
{
  "$schema": "https://openapi.vercel.sh/vercel.json",
  "functions": {
    "api/run.ts": {
      "maxDuration": 60
    }
  }
}
```

æ›´å¤šè¯¦æƒ…å‚è§ Vercel çš„[é…ç½®å‡½æ•°](https://vercel.com/docs/functions/configuring-functions)æ–‡æ¡£ã€‚

### 7. å…³è”ä½ çš„é¡¹ç›® {#7-link-your-project}

åœ¨é…ç½®ç¯å¢ƒå˜é‡ä¹‹å‰ï¼Œå°†æœ¬åœ°æ–‡ä»¶å¤¹å…³è”åˆ°ä¸€ä¸ª Vercel é¡¹ç›®ï¼š

```bash
# å¦‚æœ‰éœ€è¦ï¼Œå…ˆè¿›è¡Œè®¤è¯
vercel login

# å°†å½“å‰ç›®å½•å…³è”åˆ°ä¸€ä¸ª Vercel é¡¹ç›®ï¼ˆäº¤äº’å¼ï¼‰
vercel link
```

### 8. ç¯å¢ƒå˜é‡ {#8-environment-variables}

ç”Ÿäº§ç¯å¢ƒä¸­ä¸è¦æäº¤ `.env`ã€‚é€šè¿‡ Vercel CLI æ·»åŠ å˜é‡ï¼š

```bash
vercel env add BROWSERBASE_API_KEY
vercel env add BROWSERBASE_PROJECT_ID
# ï¼ˆå¦‚æœéœ€è¦ï¼Œä¹Ÿæ·»åŠ ä½ çš„æ¨¡å‹å¯†é’¥ï¼‰
vercel env add GOOGLE_API_KEY
```

å¦è§ï¼š[æµè§ˆå™¨ç¯å¢ƒ](/zh/configuration/environment) äº†è§£æ‰€éœ€å˜é‡çš„è¯¦æƒ…ã€‚

### 9. æœ¬åœ°æµ‹è¯• {#9-test-locally}

åœ¨æœ¬åœ°å¤ç° Vercel ç¯å¢ƒï¼Œä»¥ä¾¿åœ¨éƒ¨ç½²å‰è¿è¡Œå¹¶éªŒè¯ä½ çš„ Functionã€‚ä»é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œã€‚

```bash
# ç¡®ä¿ä¾èµ–å·²å®‰è£…
npm install

# å¯åŠ¨æœ¬åœ° Vercel å¼€å‘æœåŠ¡å™¨
vercel dev --listen 5005
```

### 10. éƒ¨ç½² {#10-deploy}

```bash
vercel
vercel --prod
```

### æ‰§è¡Œå‡½æ•° {#execute-the-function}

```bash
curl -X POST https://<your-deployment>/api/run
```

### å¯é€‰ï¼šåœ¨ Vercel ä¸Šä½¿ç”¨ Cron {#optional-cron-on-vercel}

é€šè¿‡æ‰©å±• `vercel.json`ï¼ŒæŒ‰è®¡åˆ’è§¦å‘ç›¸åŒçš„ç«¯ç‚¹ï¼š

```json
{
  "$schema": "https://openapi.vercel.sh/vercel.json",
  "functions": {
    "api/run.ts": {
      "maxDuration": 60
    }
  },
  "crons": [
    { "path": "/api/run", "schedule": "0 * * * *" }
  ]
}
```

### åŠŸèƒ½ {#features}

- ä½¿ç”¨ `env: "BROWSERBASE"` æ—¶æ— éœ€æœ¬åœ°æµè§ˆå™¨ã€‚[Browserbase](https://www.browserbase.com/) æä¾›æµè§ˆå™¨ç¯å¢ƒã€‚
- å¿«é€Ÿå“åº”ï¼šå°†æµè§ˆå™¨å·¥ä½œå¸è½½åˆ° Browserbaseï¼Œå¿«é€Ÿè¿”å› JSONã€‚
- é•¿æ—¶ä»»åŠ¡ï¼šæé«˜ `maxDuration`ï¼Œå¹¶/æˆ–æ ¹æ®å¥—é¤è€ƒè™‘ Edge è¿è¡Œæ—¶é™åˆ¶ã€‚
