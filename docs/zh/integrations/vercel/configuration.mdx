---
title: åœ¨ Next.js ä¸­ä½¿ç”¨ Stagehand
sidebarTitle: é…ç½®
description: Next.js æ˜¯ä¸€æ¬¾æµè¡Œçš„ç”Ÿäº§çº§ Web åº”ç”¨æ¡†æ¶ã€‚å®ƒä¸º [Director](https://director.ai)ã€[Brainrot](https://brainrot.run) å’Œ [Open Operator](https://operator.browserbase.com) ç­‰ Stagehand åº”ç”¨æä¾›æ”¯æŒã€‚
---

<Card
  title="æŸ¥çœ‹ Stagehand çš„ Next.js å¿«é€Ÿä¸Šæ‰‹"
  icon="github"
  href="https://github.com/browserbase/stagehand-nextjs-quickstart"
>
  å…‹éš†æˆ‘ä»¬çš„ [GitHub ä»“åº“](https://github.com/browserbase/stagehand-nextjs-quickstart)ï¼Œå³å¯åœ¨ Next.js ä¸­å¼€å§‹ä½¿ç”¨ Stagehandã€‚
</Card>

## å°† Stagehand æ·»åŠ åˆ°ç°æœ‰çš„ Next.js é¡¹ç›®
å¦‚æœä½ æƒ³åœ¨ç°æœ‰çš„ Next.js é¡¹ç›®ä¸­å¼•å…¥ Stagehandï¼Œå¯ä»¥å…ˆå®‰è£…ä»¥ä¸‹ä¾èµ–ï¼š
<Tabs>
	<Tab title="npm">
	```bash
	npm install @browserbasehq/stagehand @browserbasehq/sdk playwright zod
	```
	</Tab>

	<Tab title="pnpm">
	```bash
	pnpm add @browserbasehq/stagehand @browserbasehq/sdk playwright zod
	```
	</Tab>

	<Tab title="yarn">
	```bash
	yarn add @browserbasehq/stagehand @browserbasehq/sdk playwright zod
	```
	</Tab>
</Tabs>

### ç¼–å†™ä¸€ä¸ª server action
æ¥ä¸‹æ¥ï¼Œåœ¨ `app/stagehand/main.ts` ä¸­å°† `main` å‡½æ•°å®šä¹‰ä¸ºä¸€ä¸ª server actionã€‚è¯¥æ–‡ä»¶å°†åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªå‡½æ•°ï¼š

1. **`main`ï¼šè¿è¡Œä¸» Stagehand è„šæœ¬**
2. **`runStagehand`ï¼šåˆå§‹åŒ–å¹¶è¿è¡Œ `main` å‡½æ•°**
3. **`startBBSSession`ï¼šå¯åŠ¨ä¸€ä¸ª Browserbase ä¼šè¯**

```ts app/stagehand/main.ts
// ğŸ¤˜ Welcome to Stagehand!
// This file is from the [Stagehand docs](https://docs.stagehand.dev/sections/examples/nextjs).

"use server";

import { Stagehand } from "@browserbasehq/stagehand";
import { z } from "zod/v3";
import { Browserbase } from "@browserbasehq/sdk";

/**
 * Run the main Stagehand script
 */
async function main(stagehand: Stagehand) {
  // ä½ å¯ä»¥ä½¿ç”¨ `page` å®ä¾‹ç¼–å†™ä»»æ„ Playwright ä»£ç 
  // æ›´å¤šä¿¡æ¯ï¼šhttps://playwright.dev/docs/pom
  const page = stagehand.page;

  // åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†è·å– Stagehand å¿«é€Ÿä¸Šæ‰‹é¡µé¢çš„æ ‡é¢˜
  await page.goto("https://docs.stagehand.dev/");
  await page.act("click the quickstart link");
  const { title } = await page.extract({
    instruction: "extract the main heading of the page",
    schema: z.object({
      title: z.string(),
    }),
  });

  return title;
}

/**
 * Initialize and run the main() function
 */
export async function runStagehand(sessionId?: string) {
  const stagehand = new Stagehand({
    env: "BROWSERBASE",
    apiKey: process.env.BROWSERBASE_API_KEY,
    projectId: process.env.BROWSERBASE_PROJECT_ID,
    verbose: 1,
    logger: console.log,
    browserbaseSessionID: sessionId,
    disablePino: true,
  });
  await stagehand.init();
  await main(stagehand);
  await stagehand.close();
}

/**
 * Start a Browserbase session
 */
export async function startBBSSession() {
  const browserbase = new Browserbase();
  const session = await browserbase.sessions.create({
    projectId: process.env.BROWSERBASE_PROJECT_ID!,
  });
  const debugUrl = await browserbase.sessions.debug(session.id);
  return {
    sessionId: session.id,
    debugUrl: debugUrl.debuggerFullscreenUrl,
  };
}
```

### åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ç»„ä»¶
æ¥ä¸‹æ¥ï¼Œåˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ç»„ä»¶ï¼Œç”¨äºå¯åŠ¨ Browserbase ä¼šè¯ï¼Œå¹¶é€šè¿‡æˆ‘ä»¬åˆšå®šä¹‰çš„ server actions è¿è¡Œ `main` å‡½æ•°ã€‚æˆ‘ä»¬ä¼šå…ˆåˆ›å»ºä¸€ä¸ª Browserbase ä¼šè¯ï¼Œå°†å…¶åµŒå…¥åˆ° iframe ä¸­ï¼Œç„¶åå†è¿è¡Œ `main` å‡½æ•°ã€‚

```tsx app/components/stagehandEmbed.tsx
"use client";

import { useCallback, useState } from "react";
import { runStagehand, startBBSSession } from "@/app/stagehand/main";

export function StagehandEmbed() {
  const [sessionId, setSessionId] = useState<string | null>(null);
  const [debugUrl, setDebugUrl] = useState<string | null>(null);

  const startSession = useCallback(async () => {
    const { sessionId, debugUrl } = await startBBSSession();
    setSessionId(sessionId);
    setDebugUrl(debugUrl);
    await runStagehand(sessionId);
  }, []);

  return (
    <div>
      {!sessionId && <button onClick={startSession}>Start Session</button>}
      {sessionId && debugUrl && (
        <iframe src={debugUrl} className="w-full h-full" />
      )}
    </div>
  );
}
```

### ä½¿ç”¨ `StagehandEmbed` ç»„ä»¶
ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åº”ç”¨ä¸­ä½¿ç”¨ `StagehandEmbed` ç»„ä»¶ã€‚

```tsx app/page.tsx
import { StagehandEmbed } from "@/app/components/stagehandEmbed";

export default function Home() {
	return (
		<main>
			<StagehandEmbed />
		</main>
	)
}
```

## å‚è€ƒ

<CardGroup cols={2}>
  <Card title="Deploy Template" icon="rocket" href="https://vercel.com/templates/ai/stagehand-next-js-quickstart">
    ä¸€é”®åœ¨ Vercel éƒ¨ç½² Stagehand çš„ Next.js æ¨¡æ¿
  </Card>
  
  <Card title="Source Code" icon="github" href="https://github.com/browserbase/stagehand-nextjs-quickstart">
    åœ¨ GitHub ä¸Šæµè§ˆå®Œæ•´æ¨¡æ¿å­˜å‚¨åº“
  </Card>
</CardGroup>