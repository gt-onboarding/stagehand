---
title: æå–
description: ä»ç½‘é¡µæå–ç»“æ„åŒ–æ•°æ®
---

<div id="what-is-extract">
  ## ä»€ä¹ˆæ˜¯ `extract()`ï¼Ÿ
</div>

```typescript
page.extract("extract the name of the repository");
```

`extract` ç”¨äºä»ç½‘é¡µä¸­æå–ç»“æ„åŒ–æ•°æ®ã€‚ä½ å¯ä»¥ä½¿ç”¨ [zod](https://github.com/colinhacks/zod)ï¼ˆTypeScriptï¼‰æˆ– [pydantic](https://github.com/pydantic/pydantic)ï¼ˆPythonï¼‰æ¥å®šä¹‰ schemaã€‚å¦‚æœä¸æƒ³å®šä¹‰ schemaï¼Œä¹Ÿå¯ä»¥åªç”¨[è‡ªç„¶è¯­è¨€æç¤º](#extract-with-just-a-prompt)æ¥è°ƒç”¨ `extract`ï¼Œæˆ–[ä¸ä¼ ä»»ä½•å‚æ•°](#extract-with-no-parameters)ç›´æ¥è°ƒç”¨ `extract`ã€‚

<div id="why-use-extract">
  ## ä¸ºä»€ä¹ˆä½¿ç”¨ `extract()`ï¼Ÿ
</div>

<CardGroup cols={2}>
  <Card title="ç»“æ„åŒ–" icon="brackets-curly" href="#list-of-objects-extraction">
    å°†æ‚ä¹±çš„ç½‘é¡µæ•°æ®è½¬æ¢ä¸ºç¬¦åˆæ¶æ„çš„å¹²å‡€å¯¹è±¡ã€‚
  </Card>

  <Card title="å¥å£®" icon="dumbbell" href="#extract-with-context">
    æ„å»ºå¯¹ç½‘ç«™å˜æ›´ä¸æ•æ„Ÿã€ä¸ä¼šè½»æ˜“å¤±æ•ˆçš„æŠ½å–æ–¹æ¡ˆã€‚
  </Card>
</CardGroup>

<Note>
  å¯¹äº TypeScriptï¼ŒæŠ½å–çš„æ¶æ„ä½¿ç”¨ zod çš„ schema å®šä¹‰ã€‚
  å¯¹äº Pythonï¼ŒæŠ½å–çš„æ¶æ„ä½¿ç”¨ pydantic çš„æ¨¡å‹å®šä¹‰ã€‚
</Note>

<div id="using-extract">
  ## ä½¿ç”¨ `extract()`
</div>

<div id="single-object-extraction">
  ### å•ä¸ªå¯¹è±¡æå–
</div>

ä»¥ä¸‹æ˜¯å¯¹å•ä¸ªå¯¹è±¡è¿›è¡Œ `extract` è°ƒç”¨çš„ç¤ºä¾‹ï¼š

<CodeGroup>
  ```typescript TypeScript
  const item = await page.extract({
    instruction: "æå–è¯¥å•†å“çš„ä»·æ ¼",
    schema: z.object({
      price: z.number(),
    }),
  });
  ```

  ```python Python
  class Extraction(BaseModel):
      price: float

  item = await page.extract(
      "æå–è¯¥å•†å“çš„ä»·æ ¼", 
      schema=Extraction
  )
  ```
</CodeGroup>

è¾“å‡ºæ¨¡å¼å¦‚ä¸‹ï¼š

```Example
{ price: number }
```

<div id="list-of-objects-extraction">
  ### å¯¹è±¡åˆ—è¡¨æå–
</div>

ä»¥ä¸‹æ˜¯å¯¹å¯¹è±¡åˆ—è¡¨è¿›è¡Œ `extract` è°ƒç”¨çš„ç¤ºä¾‹ï¼š

<CodeGroup>
  ```typescript TypeScript
  const apartments = await page.extract({
    instruction:
      "æå–æ‰€æœ‰å…¬å¯“æˆ¿æºåŠå…¶è¯¦æƒ…ï¼ŒåŒ…æ‹¬åœ°å€ã€ä»·æ ¼å’Œé¢ç§¯ï¼ˆå¹³æ–¹è‹±å°ºï¼‰ã€‚",
    schema: z.object({
      list_of_apartments: z.array(
        z.object({
          address: z.string(),
          price: z.string(),
          square_feet: z.string(),
        }),
      ),
    })
  })

  console.log("the apartment list is: ", apartments);
  ```

  ```python Python
  class Apartment(BaseModel):
      address: str
      price: str
      square_feet: str

  class Apartments(BaseModel):
      list_of_apartments: list[Apartment]

  apartments = await page.extract(
      "ä»¥åˆ—è¡¨å½¢å¼æå–æ‰€æœ‰å…¬å¯“æˆ¿æºåŠå…¶è¯¦æƒ…ï¼ŒåŒ…æ‹¬æ¯å¥—å…¬å¯“çš„åœ°å€ã€ä»·æ ¼å’Œé¢ç§¯ï¼ˆå¹³æ–¹è‹±å°ºï¼‰",
      schema=Apartments
  )

  print("the apartment list is: ", apartments)
  ```
</CodeGroup>

è¾“å‡ºæ¨¡å¼å¦‚ä¸‹ï¼š

```Example
list_of_apartments: [
    {
      address: "street address here",
      price: "$1234.00",
      square_feet: "700"
    },
    {
        address: "another address here",
        price: "1010.00",
        square_feet: "500"
    },
    ...
]
```

<div id="prompt-only-extraction">
  ### ä»…ä½¿ç”¨æç¤ºçš„æå–
</div>

ä½ å¯ä»¥ä»…ä½¿ç”¨è‡ªç„¶è¯­è¨€æç¤ºæ¥è°ƒç”¨ `extract`ï¼š

<CodeGroup>
  ```typescript TypeScript
  const result = await page.extract("æå–è¯¥ä»“åº“çš„åç§°");
  ```

  ```python Python
  result = await page.extract("æå–è¯¥ä»“åº“çš„åç§°")
  ```
</CodeGroup>

å½“ä»…ä½¿ç”¨æç¤ºè°ƒç”¨ `extract` æ—¶ï¼Œè¾“å‡ºæ¨¡å¼å¦‚ä¸‹ï¼š

```Example
{ extraction: string }
```

<div id="extract-with-no-parameters">
  ### æ— å‚æ•°æå–
</div>

ä»¥ä¸‹æ˜¯åœ¨æ²¡æœ‰ä»»ä½•å‚æ•°çš„æƒ…å†µä¸‹è°ƒç”¨ `extract` çš„æ–¹æ³•ï¼š

<CodeGroup>
  ```typescript TypeScript
  const pageText = await page.extract();
  ```

  ```python Python
  page_text = await page.extract()
  ```
</CodeGroup>

è¾“å‡ºæ¨¡å¼ï¼š

```Example
{ page_text: string }
```

åœ¨ä¸ä¼ å…¥å‚æ•°çš„æƒ…å†µä¸‹è°ƒç”¨ `extract` å°†è¿”å›æ ¹ DOM çš„åˆ†å±‚æ ‘ç»“æ„è¡¨ç¤ºã€‚æ­¤ç»“æœä¸ä¼šç»è¿‡ LLM å¤„ç†ã€‚å®ƒå¤§è‡´å¦‚ä¸‹æ‰€ç¤ºï¼š

```
Accessibility Tree:
[0-2] RootWebArea: What is Stagehand? - ğŸ¤˜ Stagehand
  [0-37] scrollable
    [0-118] body
      [0-241] scrollable
        [0-242] div
          [0-244] link: ğŸ¤˜ Stagehand home page light logo
            [0-245] span
              [0-246] StaticText: ğŸ¤˜ Stagehand
              [0-247] StaticText: home page
```

<div id="best-practices">
  ## æœ€ä½³å®è·µ
</div>

<div id="extract-with-context">
  ### ç»“åˆä¸Šä¸‹æ–‡è¿›è¡ŒæŠ½å–
</div>

ä½ å¯ä»¥ä¸º schema æä¾›æ›´å¤šä¸Šä¸‹æ–‡ï¼Œå¸®åŠ©æ¨¡å‹æ›´ç²¾å‡†åœ°æŠ½å–æ•°æ®ã€‚

<CodeGroup>
  ```typescript TypeScript
  const apartments = await page.extract({
   instruction:
     "Extract ALL the apartment listings and their details, including address, price, and square feet.",
   schema: z.object({
     list_of_apartments: z.array(
       z.object({
         address: z.string().describe("the address of the apartment"),
         price: z.string().describe("the price of the apartment"),
         square_feet: z.string().describe("the square footage of the apartment"),
       }),
     ),
   })
  })
  ```

  ```python Python
  class Apartment(BaseModel):
      address: str = Field(..., description="the address of the apartment")
      price: str = Field(..., description="the price of the apartment")
      square_feet: str = Field(..., description="the square footage of the apartment")

  class Apartments(BaseModel):
      list_of_apartments: list[Apartment]

  apartments = await page.extract(
      "Extract ALL the apartment listings and their details as a list. For each apartment, include: the address of the apartment, the price of the apartment, and the square footage of the apartment",
      schema=Apartments
  )
  ```
</CodeGroup>

<div id="link-extraction">
  ### é“¾æ¥æŠ½å–
</div>

<Note>
  è¦æŠ½å–é“¾æ¥æˆ– URLï¼Œåœ¨ Stagehand çš„ TypeScript ç‰ˆæœ¬ä¸­ï¼Œéœ€è¦å°†ç›¸å…³å­—æ®µå®šä¹‰ä¸º `z.string().url()`ã€‚
  åœ¨ Python ä¸­ï¼Œéœ€è¦å°†å…¶å®šä¹‰ä¸º `HttpUrl`ã€‚
</Note>

ä¸‹é¢æ˜¯ä¸€ä¸ªç”¨äºæŠ½å–é“¾æ¥æˆ– URL çš„ `extract` è°ƒç”¨ç¤ºä¾‹ã€‚å¯¹å›¾ç‰‡é“¾æ¥åŒæ ·é€‚ç”¨ã€‚

<CodeGroup>
  ```typescript TypeScript
  const extraction = await page.extract({
    instruction: "extract the link to the 'contact us' page",
    schema: z.object({
      link: z.string().url(), // æ³¨æ„è¿™é‡Œä½¿ç”¨äº† z.string().url()
    }),
  });

  console.log("the link to the contact us page is: ", extraction.link);
  ```

  ```python Python
  class Extraction(BaseModel):
      link: HttpUrl # æ³¨æ„è¿™é‡Œä½¿ç”¨äº† HttpUrl

  extraction = await page.extract(
      "extract the link to the 'contact us' page", 
      schema=Extraction
  )

  print("the link to the contact us page is: ", extraction.link)
  ```
</CodeGroup>

<Tip>
  åœ¨ Stagehand å†…éƒ¨ï¼Œé“¾æ¥æŠ½å–çš„æ–¹å¼æ˜¯è®© LLM é€‰æ‹©ä¸€ä¸ª IDã€‚Stagehand ä¼šåœ¨ä¸€ä¸ª ID -> URL çš„æ˜ å°„ä¸­æŸ¥æ‰¾è¯¥ IDã€‚è®°å½• LLM è¿½è¸ªæ—¥å¿—æ—¶ï¼Œä½ ä¼šçœ‹åˆ°çš„æ˜¯ IDã€‚å®é™…çš„ URL ä¼šåŒ…å«åœ¨æœ€ç»ˆçš„ `ExtractResult` ä¸­ã€‚
</Tip>

<div id="troubleshooting">
  ## æ•…éšœæ’é™¤
</div>

<AccordionGroup>
  <Accordion title="ç»“æœä¸ºç©ºæˆ–ä¸å®Œæ•´">
    **é—®é¢˜**: `extract()` è¿”å›ç©ºæˆ–ä¸å®Œæ•´çš„æ•°æ®

    **è§£å†³æ–¹æ¡ˆ**:

    - **æ£€æŸ¥æŒ‡ä»¤æ˜¯å¦æ¸…æ™°**: ç¡®ä¿ä½ çš„æŒ‡ä»¤è¶³å¤Ÿå…·ä½“ï¼Œå‡†ç¡®æè¿°éœ€è¦æå–çš„æ•°æ®
    - **éªŒè¯æ•°æ®æ˜¯å¦å­˜åœ¨**: å…ˆä½¿ç”¨ `page.observe()` ç¡®è®¤é¡µé¢ä¸Šç¡®å®å­˜åœ¨è¯¥æ•°æ®
    - **ç­‰å¾…åŠ¨æ€å†…å®¹åŠ è½½**: å¦‚æœé¡µé¢ä»¥åŠ¨æ€æ–¹å¼åŠ è½½å†…å®¹ï¼Œåœ¨æå–å‰ä½¿ç”¨ `page.act("wait for the content to load")`

    **è§£å†³æ–¹æ¡ˆï¼šåœ¨æå–å‰ç­‰å¾…å†…å®¹åŠ è½½**

    <CodeGroup>
      ```typescript TypeScript
      // Wait for content before extracting
      await page.act("wait for the product listings to load");
      const products = await page.extract({
        instruction: "extract all product names and prices",
        schema: z.object({
          products: z.array(z.object({
            name: z.string(),
            price: z.string()
          }))
        })
      });
      ```

      ```python Python
      # Wait for content before extracting
      await page.act("wait for the product listings to load")
      products = await page.extract(
          "extract all product names and prices",
          schema=ProductList
      )
      ```
    </CodeGroup>
  </Accordion>

  <Accordion title="Schema éªŒè¯é”™è¯¯">
    **é—®é¢˜**: å‡ºç° Schema éªŒè¯é”™è¯¯æˆ–ç±»å‹ä¸åŒ¹é…

    **è§£å†³æ–¹æ¡ˆ**:

    - **ä½¿ç”¨å¯é€‰å­—æ®µ**: å¦‚æœæ•°æ®å¯èƒ½å¹¶éæ€»æ˜¯å­˜åœ¨ï¼Œä½¿ç”¨ `z.optional()`ï¼ˆTypeScriptï¼‰æˆ– `Optional[type]`ï¼ˆPythonï¼‰å°†å­—æ®µè®¾ä¸ºå¯é€‰
    - **ä½¿ç”¨æ›´çµæ´»çš„ç±»å‹**: å¯¹å¯èƒ½åŒ…å«è´§å¸ç¬¦å·çš„ä»·æ ¼ï¼Œè€ƒè™‘ä½¿ç”¨ `z.string()` è€Œä¸æ˜¯ `z.number()`
    - **æ·»åŠ æè¿°**: ä½¿ç”¨ `.describe()`ï¼ˆTypeScriptï¼‰æˆ– `Field(description="...")`ï¼ˆPythonï¼‰å¸®åŠ©æ¨¡å‹ç†è§£å­—æ®µè¦æ±‚

    **è§£å†³æ–¹æ¡ˆï¼šæ›´çµæ´»çš„ Schema**

    <CodeGroup>
      ```typescript TypeScript
      const schema = z.object({
        price: z.string().describe("price including currency symbol, e.g., '$19.99'"),
        availability: z.string().optional().describe("stock status if available"),
        rating: z.number().optional()
      });
      ```

      ```python Python
      class FlexibleProduct(BaseModel):
          price: str = Field(description="price including currency symbol, e.g., '$19.99'")
          availability: Optional[str] = Field(default=None, description="stock status if available")
          rating: Optional[float] = None
      ```
    </CodeGroup>
  </Accordion>

  <Accordion title="ç»“æœä¸ä¸€è‡´">
    **é—®é¢˜**: ä¸åŒè¿è¡Œä¹‹é—´çš„æå–ç»“æœä¸ä¸€è‡´

    **è§£å†³æ–¹æ¡ˆ**:

    - **ä½¿æŒ‡ä»¤æ›´å…·ä½“**: ä¾‹å¦‚å°†â€œextract pricesâ€æ”¹ä¸ºâ€œextract the numerical price value for each itemâ€
    - **åœ¨ Schema æè¿°ä¸­æä¾›ä¸Šä¸‹æ–‡**: æ·»åŠ å­—æ®µæè¿°ä»¥å¼•å¯¼æ¨¡å‹
    - **é…åˆ observe ä½¿ç”¨**: å…ˆç”¨ `page.observe()` äº†è§£é¡µé¢ç»“æ„

    **è§£å†³æ–¹æ¡ˆï¼šå…ˆç”¨ observe éªŒè¯**

    <CodeGroup>
      ```typescript TypeScript
      // First observe to understand the page structure
      const elements = await page.observe("find all product listings");
      console.log("Found elements:", elements.map(e => e.description));

      // Then extract with specific targeting
      const products = await page.extract({
        instruction: "extract name and price from each product listing shown on the page",
        schema: z.object({
          products: z.array(z.object({
            name: z.string().describe("the product title or name"),
            price: z.string().describe("the price as displayed, including currency")
          }))
        })
      });
      ```

      ```python Python
      # First observe to understand the page structure
      elements = await page.observe("find all product listings")
      print("Found elements:", [e.description for e in elements])

      # Then extract with specific targeting
      products = await page.extract(
          "extract name and price from each product listing shown on the page",
          schema=ProductSchema
      )
      ```
    </CodeGroup>
  </Accordion>

  <Accordion title="æ€§èƒ½é—®é¢˜">
    **é—®é¢˜**ï¼šæå–è¿‡ç¨‹ç¼“æ…¢æˆ–å‡ºç°è¶…æ—¶

    **è§£å†³æ–¹æ¡ˆ**ï¼š

    - **ç¼©å°èŒƒå›´**ï¼šé€šè¿‡å¤šæ¬¡è°ƒç”¨åˆ†æ‰¹æå–è¾ƒå°çš„æ•°æ®å—ï¼Œè€Œéä¸€æ¬¡æ€§æå–å…¨éƒ¨
    - **ä½¿ç”¨é’ˆå¯¹æ€§æŒ‡ä»¤**ï¼šæ˜ç¡®æŒ‡å®šéœ€è¦å…³æ³¨çš„é¡µé¢éƒ¨åˆ†
    - **è€ƒè™‘åˆ†é¡µ**ï¼šå¯¹äºå¤§å‹æ•°æ®é›†ï¼ŒæŒ‰é¡µé€æ­¥æå–
    - **å¢åŠ è¶…æ—¶æ—¶é—´**ï¼šå¯¹å¤æ‚çš„æå–ä½¿ç”¨ `timeoutMs` å‚æ•°

    **æ–¹æ¡ˆï¼šæ‹†è§£å¤§è§„æ¨¡æå–ä»»åŠ¡**

    <CodeGroup>
      ```typescript TypeScript
      // Instead of extracting everything at once
      const allData = [];
      const pageNumbers = [1, 2, 3, 4, 5];

      for (const pageNum of pageNumbers) {
        await page.act(`navigate to page ${pageNum}`);
        
        const pageData = await page.extract({
          instruction: "extract product data from the current page only",
          schema: ProductPageSchema,
          timeoutMs: 60000 // 60 second timeout
        });
        
        allData.push(...pageData.products);
      }
      ```

      ```python Python
      # Instead of extracting everything at once
      all_data = []
      page_numbers = [1, 2, 3, 4, 5]

      for page_num in page_numbers:
          await page.act(f"navigate to page {page_num}")
          
          page_data = await page.extract(
              "extract product data from the current page only",
              schema=ProductPageSchema,
              timeout_ms=60000  # 60 second timeout
          )
          
          all_data.extend(page_data.products)
      ```
    </CodeGroup>
  </Accordion>
</AccordionGroup>

<div id="next-steps">
  ## ä¸‹ä¸€æ­¥
</div>

<CardGroup cols={2}>
  <Card title="Act" icon="play" href="/zh/basics/act">
    åŸºäº observe çš„ç»“æœé«˜æ•ˆæ‰§è¡Œæ“ä½œ
  </Card>

  <Card title="Observe" icon="magnifying-glass" href="/zh/basics/observe">
    ä½¿ç”¨ observe() åˆ†æé¡µé¢
  </Card>
</CardGroup>